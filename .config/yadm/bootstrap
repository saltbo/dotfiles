#!/bin/sh

system_type=$(uname -s)
echo "${system_type}"

is_command() {
    command -v "$1" > /dev/null 2>&1
}

UNAME_MACHINE="$(/usr/bin/uname -m)"
if [[ "${UNAME_MACHINE}" == "arm64" ]]
then
    # On ARM macOS, this script installs to /opt/homebrew only
    HOMEBREW_PREFIX="/opt/homebrew"
else
    # On Intel macOS, this script installs to /usr/local only
    HOMEBREW_PREFIX="/usr/local"
fi

installcmd(){
    if [ ! -d "$HOMEBREW_PREFIX/Cellar/$1" ]; then
        echo "brew install $1"
        brew install "$1"
        if [ $? -eq 0 ]; then
            echo "$1 are installed."
        else
            echo "Install $1 error."
        fi
    fi
}

installapp(){
    if [ ! -d "$HOMEBREW_PREFIX/Caskroom/$1" ]; then
        echo "brew install --cask $1"
        brew install --cask $1
        if [ $? -eq 0 ]; then
            echo "$1 are installed."
        else
            echo "Install $1 error."
        fi
    fi
}


if [ ${system_type} = "Darwin" ]; then
    cmds=(gnupg lrzsz lazygit go docker docker-compose kind kubernetes-cli kubectx k9s) 
    for cmd in ${cmds[@]}
    do
        installcmd $cmd
    done

    apps=(iterm2 goland clion visual-studio-code google-chrome bob utools enpass sourcetree wechat notion neteasemusic sequel-pro)
    for app in ${apps[@]}
    do
        installapp $app
    done
fi

